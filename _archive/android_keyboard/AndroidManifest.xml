<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="com.example.flirtkeyboard">

    <!-- ============================================ -->
    <!-- PERMISSÕES NECESSÁRIAS -->
    <!-- ============================================ -->

    <!-- Permissão para fazer chamadas de rede -->
    <uses-permission android:name="android.permission.INTERNET" />

    <!-- Permissão para acessar o estado da rede (opcional, mas recomendado) -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <!-- ============================================ -->
    <!-- CONFIGURAÇÕES DE SEGURANÇA DE REDE -->
    <!-- ============================================ -->

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.FlirtKeyboard"
        android:usesCleartextTraffic="true"
        tools:targetApi="31">

        <!--
            usesCleartextTraffic="true" permite HTTP (não-HTTPS)
            IMPORTANTE: Use apenas para desenvolvimento local (localhost)
            Para produção, SEMPRE use HTTPS e remova esta flag
        -->

        <!-- ============================================ -->
        <!-- CONFIGURAÇÃO DO SERVIÇO DE TECLADO -->
        <!-- ============================================ -->

        <service
            android:name=".FlirtKeyboardService"
            android:label="@string/keyboard_name"
            android:permission="android.permission.BIND_INPUT_METHOD"
            android:exported="true">

            <!--
                android:permission="android.permission.BIND_INPUT_METHOD"
                OBRIGATÓRIO: Garante que apenas o sistema pode se conectar ao teclado
                Previne que outros apps abusem do serviço
            -->

            <!-- Intent Filter: Define este serviço como um Input Method -->
            <intent-filter>
                <action android:name="android.view.InputMethod" />
            </intent-filter>

            <!-- Meta-data: Referencia o arquivo de configuração XML do teclado -->
            <meta-data
                android:name="android.view.im"
                android:resource="@xml/method" />

        </service>

        <!-- ============================================ -->
        <!-- ACTIVITY PRINCIPAL (OPCIONAL) -->
        <!-- ============================================ -->

        <!--
            Esta activity pode ser usada para:
            - Mostrar instruções de uso
            - Configurações do teclado
            - Tutorial de ativação
        -->
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    </application>

</manifest>

<!--
╔════════════════════════════════════════════════════════════════════════════╗
║                    NOTAS IMPORTANTES DE CONFIGURAÇÃO                        ║
╚════════════════════════════════════════════════════════════════════════════╝

1. PERMISSÕES:
   ✓ INTERNET - Obrigatória para chamadas HTTP
   ✓ BIND_INPUT_METHOD - Obrigatória para teclados customizados (proteção do sistema)
   ✓ Clipboard - Não requer permissão explícita, mas Android 10+ mostra toast ao acessar

2. CLEARTEXT TRAFFIC (HTTP):
   ⚠️ usesCleartextTraffic="true" permite HTTP não-criptografado
   ⚠️ Use APENAS para desenvolvimento local (localhost/10.0.2.2)
   ⚠️ Para produção: remova esta flag e use HTTPS

   Alternativa mais segura para desenvolvimento:
   - Crie res/xml/network_security_config.xml
   - Permita cleartext apenas para localhost
   - Veja exemplo abaixo

3. EXPORTED="true":
   ✓ Necessário para o serviço ser descoberto pelo sistema
   ✓ Protegido pela permissão BIND_INPUT_METHOD

4. ARQUIVOS ADICIONAIS NECESSÁRIOS:
   - res/xml/method.xml (configuração do Input Method)
   - res/values/strings.xml (com keyboard_name)

═══════════════════════════════════════════════════════════════════════════════

EXEMPLO: Network Security Config (mais seguro)

Crie: res/xml/network_security_config.xml

<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <base-config cleartextTrafficPermitted="false" />
    <domain-config cleartextTrafficPermitted="true">
        <domain includeSubdomains="true">localhost</domain>
        <domain includeSubdomains="true">10.0.2.2</domain>
    </domain-config>
</network-security-config>

E no AndroidManifest.xml, substitua usesCleartextTraffic por:
android:networkSecurityConfig="@xml/network_security_config"

═══════════════════════════════════════════════════════════════════════════════

COMO ATIVAR O TECLADO NO ANDROID:

1. Instale o app no dispositivo/emulador
2. Vá em: Configurações > Sistema > Idiomas e entrada > Teclado virtual
3. Toque em "Gerenciar teclados" ou "Teclados no dispositivo"
4. Ative o "Flirt Keyboard"
5. Em qualquer campo de texto, toque no ícone do teclado na barra de navegação
6. Selecione "Flirt Keyboard"

TROUBLESHOOTING:
- Teclado não aparece na lista: Verifique permissão BIND_INPUT_METHOD
- Erro de rede: Verifique usesCleartextTraffic e backend rodando
- Clipboard não funciona: Normal no Android 10+, mas deve funcionar
- Layout não aparece: Verifique res/layout/keyboard_layout.xml e res/xml/method.xml

╚════════════════════════════════════════════════════════════════════════════╝
-->
