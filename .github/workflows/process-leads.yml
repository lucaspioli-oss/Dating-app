name: Process Abandoned Leads

on:
  schedule:
    # Executa a cada hora
    - cron: '0 * * * *'
  workflow_dispatch: # Permite executar manualmente

jobs:
  process-leads:
    runs-on: ubuntu-latest
    steps:
      - name: Send follow-up emails to abandoned leads
        run: |
          response=$(curl -s -X POST https://dating-app-production-ac43.up.railway.app/process-abandoned-leads \
            -H "Content-Type: application/json")
          echo "Response: $response"

          # Extrair m√©tricas
          processed=$(echo $response | jq -r '.processed // 0')
          emails_sent=$(echo $response | jq -r '.emailsSent // 0')
          total=$(echo $response | jq -r '.totalLeads // 0')

          echo "üìß Leads processados: $processed"
          echo "‚úâÔ∏è Emails enviados: $emails_sent"
          echo "üìä Total de leads: $total"
